<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Flor interactiva automÃ¡tica</title>
  <style>
    html,body{
      height:100%;
      margin:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background:black;
      overflow:hidden;
    }
    canvas{
      display:block;
    }
    /* Recuadro inicial */
    #startBox {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 0, 0.9);
      color: black;
      font-size: 22px;
      font-family: Arial, sans-serif;
      padding: 20px 40px;
      border-radius: 15px;
      cursor: pointer;
      box-shadow: 0 0 15px yellow;
      text-align: center;
      z-index: 10;
      transition: opacity 1s ease;
        font-size: 5vw;      /* TamaÃ±o de fuente relativo al ancho de pantalla */
  padding: 3vw 7vw;    /* Padding tambiÃ©n relativo */
  max-width: 90vw;     /* Evita que se salga en pantallas pequeÃ±as */
  box-sizing: border-box;
    }
    /* Texto superior */
    #mensaje {
      position: absolute;
      top: 20px;
      width: 100%;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
      color: gold;
      font-family: "Verdana", sans-serif;
      text-shadow: 0 0 15px yellow, 0 0 25px orange;
      display: none;
       font-size: 6vw;      /* TamaÃ±o de fuente relativo */
  padding: 1vw 2vw;
  max-width: 95vw;
  box-sizing: border-box;
    }
    /* Mensaje final */
    #finalMsg {
      position: absolute;
      top: 65%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 26px;
      font-weight: bold;
      color: white;
      font-family: "Comic Sans MS", cursive, sans-serif;
      text-shadow: 0 0 10px pink, 0 0 20px red;
      display: none;
      animation: aparecer 2s ease forwards;
      white-space: nowrap;   /* ðŸš€ evita el salto de lÃ­nea */
        font-size: 5vw;
  max-width: 95vw;
  white-space: normal; /* Permite salto de lÃ­nea si es necesario */
  padding: 2vw 4vw;
  box-sizing: border-box;
    }
    @keyframes aparecer {
      from {opacity: 0; transform: translate(-50%, -40%);}
      to {opacity: 1; transform: translate(-50%, -50%);}
    }
  </style>
</head>
<body>
  <div id="startBox">ðŸŒ¸ Dar click para empezar ðŸŒ¸</div>
  <div id="mensaje">ðŸŒ» Feliz 21 de septiembre ðŸŒ»</div>
  <div id="finalMsg">âœ¨ Este 21 de septiembre no seas solo espectadora âœ¨</div>
  <canvas id="c"></canvas>
 <!-- ðŸŽµ Audio de fondo -->
  <audio id="musica" src="musica.mp3"></audio>
<script>
/* =====================
   ConfiguraciÃ³n inicial
   ===================== */
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let W = innerWidth, H = innerHeight;
canvas.width = W; canvas.height = H;

let stars = [];
for(let i=0;i<150;i++){
  stars.push({x:Math.random()*W, y:Math.random()*H, r:Math.random()*2, s:Math.random()*0.5+0.2});
}

let stage = 0;
const MAX_STAGES = 6;
let stemCurrent = 40, stemTarget = 40;
let leafOpacity = 0, petalScale = 0, blossomOpen = 0;
const scaleFactor = 1.4;
let baseX = W/2, baseY = H-10;
let autoGrow = false;

/* =====================
   Estrellas de fondo
   ===================== */
function drawStars(){
  ctx.fillStyle="black";
  ctx.fillRect(0,0,W,H);
  ctx.fillStyle="white";
  for(const s of stars){
    ctx.globalAlpha = Math.random()*0.8+0.2;
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
  }
  ctx.globalAlpha=1;
}

/* =====================
   AnimaciÃ³n de la flor
   ===================== */
function updatePhysics(){
  stemTarget = 40 + stage*40;
  stemCurrent += (stemTarget - stemCurrent) * 0.1;
  let leafGoal = (stage >= 1) ? 1 : 0;
  leafOpacity += (leafGoal - leafOpacity) * 0.08;
  let petalGoal = (stage >= 4) ? 1 : Math.max(0,(stage-3)/(MAX_STAGES-3));
  petalScale += (petalGoal - petalScale)*0.1;
  blossomOpen += (petalScale - blossomOpen)*0.08;
}

function drawScene(){
  drawStars();

  if(autoGrow){   // ðŸŒ¸ solo dibuja la flor despuÃ©s de dar clic
    drawStem(baseX, baseY, stemCurrent*scaleFactor);
    if (leafOpacity > 0.02) drawLeaves(baseX, baseY, stemCurrent*scaleFactor, leafOpacity);
    if (stage < 4) drawBud(baseX, baseY-stemCurrent*scaleFactor);
    if (stage > 2) drawFlower(baseX, baseY-stemCurrent*scaleFactor, blossomOpen);
  }
}

function animate(){
  updatePhysics();
  drawScene();
  requestAnimationFrame(animate);
}

/* =====================
   Flor y partes
   ===================== */
function drawStem(x,groundY,height){
  const topY = groundY-height; 
  ctx.save();
  ctx.lineWidth=14*scaleFactor; ctx.strokeStyle='#0a3b12'; ctx.lineCap='round';
  ctx.beginPath(); ctx.moveTo(x,groundY);
  ctx.bezierCurveTo(x+20,groundY-height*0.3, x-20,topY+height*0.4, x,topY); 
  ctx.stroke();
  ctx.strokeStyle='#17a12f'; ctx.lineWidth=10*scaleFactor;
  ctx.beginPath(); ctx.moveTo(x,groundY);
  ctx.bezierCurveTo(x+15,groundY-height*0.28, x-15,topY+height*0.38, x,topY); 
  ctx.stroke();
  ctx.restore();
}

function drawLeaves(x,groundY,height,opacity){
  ctx.save(); ctx.globalAlpha=0.7*opacity; ctx.fillStyle='#0f8b3f';
  ctx.beginPath(); ctx.moveTo(x-6,groundY-Math.round(height*0.4));
  ctx.bezierCurveTo(x-100,groundY-Math.round(height*0.55), x-70,groundY-Math.round(height*0.1), x+2,groundY-Math.round(height*0.2));
  ctx.fill();
  ctx.fillStyle='#18b24e'; ctx.beginPath();
  ctx.moveTo(x+6,groundY-Math.round(height*0.55));
  ctx.bezierCurveTo(x+100,groundY-Math.round(height*0.75), x+70,groundY-Math.round(height*0.25), x+2,groundY-Math.round(height*0.35));
  ctx.fill();
  ctx.restore();
}

function drawBud(x,y){
  ctx.save(); ctx.translate(x,y); ctx.fillStyle='#ffe066';
  const s=18+(stage*6); const scaledS = s*scaleFactor;
  ctx.beginPath(); ctx.ellipse(0,0,scaledS*0.9,scaledS*1.3,0,0,Math.PI*2); ctx.fill();
  ctx.fillStyle='#111'; ctx.beginPath();
  ctx.ellipse(0,0,Math.max(6,scaledS*0.4),Math.max(6,scaledS*0.4),0,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

function drawFlower(x,y,openFactor){
  ctx.save(); ctx.translate(x,y);
  const petals=8, petalMaxRadius=62*scaleFactor, petalSize=36*scaleFactor, spread=openFactor;
  for(let i=0;i<petals;i++){
    const ang=(Math.PI*2/petals)*i;
    const rx=Math.cos(ang)*(20+petalMaxRadius*spread);
    const ry=Math.sin(ang)*(12+petalMaxRadius*spread*0.9);
    ctx.save(); ctx.translate(rx,ry);
    ctx.rotate(ang+Math.PI/8*(1-spread));
    const g=ctx.createLinearGradient(-petalSize,0,petalSize,0);
    g.addColorStop(0,'#fff700');
    g.addColorStop(0.6,'#ffe066');
    g.addColorStop(1,'#ffd700');
    ctx.fillStyle=g;
    ctx.beginPath(); 
    ctx.ellipse(0,0,petalSize*(0.6+0.4*spread),petalSize*(1.1-0.2*spread),0,0,Math.PI*2); 
    ctx.fill();
    ctx.restore();
  }
  const centerR = (30 + 20*openFactor) * scaleFactor;
  const gradient = ctx.createRadialGradient(0,0,0,0,0,centerR);
  gradient.addColorStop(0, '#000000');
  gradient.addColorStop(1, '#8B4513');
  ctx.fillStyle = gradient;
  ctx.beginPath(); ctx.arc(0,0,centerR,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

/* =====================
   Click centro = mensaje
   ===================== */
canvas.addEventListener("click", (e)=>{
  // Distancia al centro de la flor
  let flowerX = baseX;
  let flowerY = baseY - stemCurrent*scaleFactor;
  let dx = e.clientX - flowerX;
  let dy = e.clientY - flowerY;
  let dist = Math.sqrt(dx*dx + dy*dy);

  if(dist < 60*scaleFactor){ 
    stage = MAX_STAGES; 
    document.getElementById("finalMsg").style.display = "block";
  }
});

/* =====================
   Recuadro inicial
   ===================== */
document.getElementById("startBox").addEventListener("click", ()=>{
  document.getElementById("startBox").style.opacity = 0;
  setTimeout(()=>{
    document.getElementById("startBox").style.display = "none";
    document.getElementById("mensaje").style.display = "block";
    autoGrow = true;
     // ðŸš€ Reproducir mÃºsica cuando termina de crecer
        const musica = document.getElementById("musica");
        musica.play().catch(err => {
          console.log("El navegador bloqueÃ³ el autoplay, pero el clic inicial ya lo deberÃ­a habilitar:", err);
        });
    // crecimiento automÃ¡tico por etapas
    let growInterval = setInterval(()=>{
      if(stage < MAX_STAGES){
        stage++;
      } else {
        clearInterval(growInterval);
      }
    }, 1000);
  },800);
});

/* =====================
   Iniciar animaciÃ³n
   ===================== */
animate();
</script>
</body>
</html>
